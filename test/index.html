<!doctype html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SwiftCart</title>

    <!-- DaisyUI + Tailwind -->
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PRODUCTS SECTION
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="products-section" id="products">
      <div class="max-w-7xl mx-auto">
        <div class="flex flex-wrap items-end justify-between gap-4 mb-2">
          <div>
            <p class="section-label">Our Store</p>
            <h2 class="section-title">Browse Products</h2>
          </div>
        </div>

        <!-- Category filters -->
        <div class="category-filters" id="categoryFilters">
          <button class="filter-btn active" data-category="all">All</button>
          <!-- JS will inject more buttons here -->
        </div>

        <!-- Product grid -->
        <div class="product-grid" id="productGrid">
          <!-- Skeleton placeholders shown while loading -->
          <div class="skeleton-card">
            <div class="skeleton-img"></div>
            <div
              class="skeleton-text"
              style="width: 80%; margin-top: 1rem"
            ></div>
            <div class="skeleton-text" style="width: 50%"></div>
            <div
              class="skeleton-text"
              style="width: 65%; margin-bottom: 1rem"
            ></div>
          </div>
          <div class="skeleton-card">
            <div class="skeleton-img"></div>
            <div
              class="skeleton-text"
              style="width: 80%; margin-top: 1rem"
            ></div>
            <div class="skeleton-text" style="width: 50%"></div>
            <div
              class="skeleton-text"
              style="width: 65%; margin-bottom: 1rem"
            ></div>
          </div>
          <div class="skeleton-card">
            <div class="skeleton-img"></div>
            <div
              class="skeleton-text"
              style="width: 80%; margin-top: 1rem"
            ></div>
            <div class="skeleton-text" style="width: 50%"></div>
            <div
              class="skeleton-text"
              style="width: 65%; margin-bottom: 1rem"
            ></div>
          </div>
          <div class="skeleton-card">
            <div class="skeleton-img"></div>
            <div
              class="skeleton-text"
              style="width: 80%; margin-top: 1rem"
            ></div>
            <div class="skeleton-text" style="width: 50%"></div>
            <div
              class="skeleton-text"
              style="width: 65%; margin-bottom: 1rem"
            ></div>
          </div>
        </div>
      </div>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PRODUCT DETAILS MODAL
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal-overlay" id="detailsModal">
      <div class="modal-box">
        <button class="modal-close" id="modalClose">âœ•</button>
        <img src="" alt="" class="modal-img" id="modalImg" />
        <div
          style="
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
          "
        >
          <span
            id="modalBadge"
            style="
              background: var(--accent-light);
              color: var(--accent);
              font-size: 0.7rem;
              font-weight: 600;
              letter-spacing: 0.08em;
              text-transform: uppercase;
              padding: 0.25rem 0.75rem;
              border-radius: 50px;
            "
          ></span>
          <span
            id="modalRating"
            style="font-size: 0.85rem; color: #6b7280"
          ></span>
        </div>
        <h2 class="modal-title" id="modalTitle"></h2>
        <p class="modal-desc" id="modalDesc"></p>
        <div class="modal-price" id="modalPrice"></div>
        <div class="modal-actions">
          <button class="btn-buy" id="modalBuyBtn">Buy Now</button>
          <button class="btn-add-modal" id="modalCartBtn">Add to Cart</button>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         CART SIDEBAR
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="cart-overlay" id="cartOverlay"></div>

    <aside class="cart-sidebar" id="cartSidebar">
      <div class="cart-header">
        <h2 class="cart-title">Your Cart</h2>
        <button class="modal-close" id="cartClose">âœ•</button>
      </div>

      <div class="cart-items" id="cartItems">
        <div class="cart-empty">
          <div class="cart-empty-icon">ðŸ›’</div>
          <p style="font-size: 0.9rem; font-weight: 500">Your cart is empty</p>
          <p style="font-size: 0.8rem; margin-top: 0.3rem">
            Add some products to get started
          </p>
        </div>
      </div>

      <div class="cart-footer">
        <div class="cart-total">
          <span class="cart-total-label">Total</span>
          <span class="cart-total-price" id="cartTotal">$0.00</span>
        </div>
        <button class="btn-checkout">Checkout</button>
      </div>
    </aside>

    <!-- Toast container -->
    <div class="toast-wrap" id="toastWrap"></div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         JAVASCRIPT
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <script>
      // â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      let allProducts = [];
      let cart = JSON.parse(localStorage.getItem("swiftcart")) || [];
      let currentProduct = null;

      // â”€â”€ API helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const BASE = "https://fakestoreapi.com";

      async function fetchJSON(url) {
        const res = await fetch(url);
        return res.json();
      }

      // â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function showToast(msg) {
        const wrap = document.getElementById("toastWrap");
        const t = document.createElement("div");
        t.className = "toast";
        t.innerHTML = `âœ“ ${msg}`;
        wrap.appendChild(t);
        setTimeout(() => t.remove(), 3000);
      }

      // â”€â”€ Stars helper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function renderStars(rate) {
        const full = Math.round(rate);
        return "â˜…".repeat(full) + "â˜†".repeat(5 - full);
      }

      // â”€â”€ Cart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function saveCart() {
        localStorage.setItem("swiftcart", JSON.stringify(cart));
      }

      function updateCartUI() {
        const count = cart.reduce((s, i) => s + i.qty, 0);
        document.getElementById("cartCount").textContent = count;

        const total = cart.reduce((s, i) => s + i.price * i.qty, 0);
        document.getElementById("cartTotal").textContent =
          `$${total.toFixed(2)}`;

        const container = document.getElementById("cartItems");

        if (cart.length === 0) {
          container.innerHTML = `
            <div class="cart-empty">
              <div class="cart-empty-icon">ðŸ›’</div>
              <p style="font-size:0.9rem;font-weight:500;">Your cart is empty</p>
              <p style="font-size:0.8rem;margin-top:0.3rem;">Add some products to get started</p>
            </div>`;
          return;
        }

        container.innerHTML = cart
          .map(
            (item) => `
          <div class="cart-item">
            <img src="${item.image}" alt="${item.title}" class="cart-item-img" />
            <div class="cart-item-info">
              <div class="cart-item-name">${item.title}</div>
              <div class="cart-item-price">$${(item.price * item.qty).toFixed(2)}</div>
              <div style="font-size:0.75rem;color:#9ca3af;">Qty: ${item.qty}</div>
            </div>
            <button class="cart-remove" onclick="removeFromCart(${item.id})">âœ•</button>
          </div>`,
          )
          .join("");
      }

      function addToCart(product) {
        const existing = cart.find((i) => i.id === product.id);
        if (existing) {
          existing.qty++;
        } else {
          cart.push({ ...product, qty: 1 });
        }
        saveCart();
        updateCartUI();
        showToast(`${product.title.substring(0, 30)}... added`);
      }

      function removeFromCart(id) {
        cart = cart.filter((i) => i.id !== id);
        saveCart();
        updateCartUI();
      }

      // â”€â”€ Cart sidebar toggle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const cartToggle = document.getElementById("cartToggle");
      const cartSidebar = document.getElementById("cartSidebar");
      const cartOverlay = document.getElementById("cartOverlay");
      const cartClose = document.getElementById("cartClose");

      function openCart() {
        cartSidebar.classList.add("open");
        cartOverlay.classList.add("open");
      }
      function closeCart() {
        cartSidebar.classList.remove("open");
        cartOverlay.classList.remove("open");
      }

      cartToggle.addEventListener("click", openCart);
      cartClose.addEventListener("click", closeCart);
      cartOverlay.addEventListener("click", closeCart);

      // â”€â”€ Details Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const modal = document.getElementById("detailsModal");
      const modalClose = document.getElementById("modalClose");

      function openModal(product) {
        currentProduct = product;
        document.getElementById("modalImg").src = product.image;
        document.getElementById("modalImg").alt = product.title;
        document.getElementById("modalTitle").textContent = product.title;
        document.getElementById("modalDesc").textContent = product.description;
        document.getElementById("modalPrice").textContent =
          `$${product.price.toFixed(2)}`;
        document.getElementById("modalBadge").textContent = product.category;
        document.getElementById("modalRating").textContent =
          `${renderStars(product.rating.rate)} (${product.rating.count} reviews)`;
        modal.classList.add("open");
        document.body.style.overflow = "hidden";
      }

      function closeModal() {
        modal.classList.remove("open");
        document.body.style.overflow = "";
      }

      modalClose.addEventListener("click", closeModal);
      modal.addEventListener("click", (e) => {
        if (e.target === modal) closeModal();
      });

      document.getElementById("modalCartBtn").addEventListener("click", () => {
        if (currentProduct) {
          addToCart(currentProduct);
          closeModal();
        }
      });

      document.getElementById("modalBuyBtn").addEventListener("click", () => {
        if (currentProduct) {
          addToCart(currentProduct);
          closeModal();
          openCart();
        }
      });

      // â”€â”€ Render product card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function renderCard(p) {
        return `
          <div class="product-card">
            <div class="product-img-wrap">
              <span class="product-category-badge">${p.category}</span>
              <img src="${p.image}" alt="${p.title}" loading="lazy" />
            </div>
            <div class="product-info">
              <div class="product-title" title="${p.title}">${p.title}</div>
              <div class="product-rating">
                <span class="stars">${renderStars(p.rating.rate)}</span>
                <span class="rating-count">(${p.rating.count})</span>
              </div>
              <div class="product-price">$${p.price.toFixed(2)}</div>
              <div class="product-actions">
                <button class="btn-details" onclick='openModal(${JSON.stringify(p)})'>Details</button>
                <button class="btn-cart"    onclick='addToCart(${JSON.stringify(p)})'>+ Cart</button>
              </div>
            </div>
          </div>`;
      }

      // â”€â”€ Render trending card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function renderTrendingCard(p, rank) {
        return `
          <div class="trending-card">
            <span class="trending-rank">${String(rank).padStart(2, "0")}</span>
            <img src="${p.image}" alt="${p.title}" class="trending-img" />
            <div class="trending-info">
              <div class="trending-title" title="${p.title}">${p.title}</div>
              <div class="stars" style="font-size:0.8rem;margin-bottom:0.25rem;">${renderStars(p.rating.rate)}</div>
              <div class="trending-price">$${p.price.toFixed(2)}</div>
            </div>
          </div>`;
      }

      // â”€â”€ Load categories â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      async function loadCategories() {
        const cats = await fetchJSON(`${BASE}/products/categories`);
        const container = document.getElementById("categoryFilters");
        container.innerHTML = `<button class="filter-btn active" data-category="all">All</button>`;
        cats.forEach((cat) => {
          const btn = document.createElement("button");
          btn.className = "filter-btn";
          btn.dataset.category = cat;
          btn.textContent = cat;
          container.appendChild(btn);
        });

        // Delegate click
        container.addEventListener("click", (e) => {
          const btn = e.target.closest(".filter-btn");
          if (!btn) return;
          container
            .querySelectorAll(".filter-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          filterProducts(btn.dataset.category);
        });
      }

      // â”€â”€ Filter products â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function filterProducts(category) {
        const filtered =
          category === "all"
            ? allProducts
            : allProducts.filter((p) => p.category === category);
        document.getElementById("productGrid").innerHTML = filtered
          .map(renderCard)
          .join("");
      }

      // â”€â”€ Load all products â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      async function loadProducts() {
        const products = await fetchJSON(`${BASE}/products`);
        allProducts = products;

        // Product grid
        document.getElementById("productGrid").innerHTML = products
          .map(renderCard)
          .join("");

        // Trending â€” top 3 by rating
        const trending = [...products]
          .sort((a, b) => b.rating.rate - a.rating.rate)
          .slice(0, 3);
        document.getElementById("trendingGrid").innerHTML = trending
          .map((p, i) => renderTrendingCard(p, i + 1))
          .join("");
      }

      // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      async function init() {
        updateCartUI();
        await Promise.all([loadCategories(), loadProducts()]);
      }

      init();
    </script>
  </body>
</html>
